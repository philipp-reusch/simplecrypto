Object subclass: #SimpleBlock	instanceVariableNames: 'bytes'	classVariableNames: ''	poolDictionaries: ''	category: 'SimpleCrypto-Base'!!SimpleBlock commentStamp: 'szktty 6/3/2011 01:34' prior: 0!A SimpleBlock represents 4 words (512 bits).!!SimpleBlock methodsFor: 'initialize-release' stamp: 'szktty 6/3/2011 14:10'!initialize	bytes := ByteArray new: self class blockSize! !!SimpleBlock methodsFor: 'initialize-release' stamp: 'szktty 6/3/2011 14:11'!with: newBytes	bytes := ByteArray withAll: (newBytes copyFrom: 1 to: self class blockSize)! !!SimpleBlock methodsFor: 'printing' stamp: 'szktty 6/3/2011 14:14'!printOn: stream	stream nextPutAll: '#b['.	bytes allButLastDo: [ :byte |		stream nextPutAll: byte hex, ' ' ].	stream nextPutAll: bytes last hex, ']'! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!SimpleBlock class	instanceVariableNames: ''!!SimpleBlock class methodsFor: 'instance creation' stamp: 'szktty 6/3/2011 14:08'!with: bytes	^ self new with: bytes! !!SimpleBlock class methodsFor: 'accessing' stamp: 'szktty 6/3/2011 01:53'!blockSize	^ 64! !Object subclass: #SimpleWord	instanceVariableNames: 'b1 b2 b3 b4'	classVariableNames: ''	poolDictionaries: ''	category: 'SimpleCrypto-Base'!!SimpleWord commentStamp: 'szktty 6/3/2011 01:34' prior: 0!A SimpleWord represents word bytes (32 bits, 4 bytes).!!SimpleWord methodsFor: 'initialize-release' stamp: 'szktty 6/2/2011 01:09'!initialize	b1 := 0.	b2 := 0.	b3 := 0.	b4 := 0! !!SimpleWord methodsFor: 'initialize-release' stamp: 'szktty 6/2/2011 01:09'!withAll: bytes	b1 := bytes at: 1.	b2 := bytes at: 2.	b3 := bytes at: 3.	b4 := bytes at: 4.! !!SimpleWord methodsFor: 'word manipulation' stamp: 'szktty 6/6/2011 01:03'!+ other	^ self class withInteger: self asInteger + other asInteger! !!SimpleWord methodsFor: 'word manipulation' stamp: 'szktty 6/2/2011 01:47'!wordAnd: otherWord	^ self class		with: (b1 bitAnd: otherWord byte1)		with: (b2 bitAnd: otherWord byte2)		with: (b3 bitAnd: otherWord byte3)		with: (b4 bitAnd: otherWord byte4)! !!SimpleWord methodsFor: 'word manipulation' stamp: 'szktty 6/5/2011 22:53'!wordNot	^ self wordXor: (self class withAll: 16rffffffff asByteArray)! !!SimpleWord methodsFor: 'word manipulation' stamp: 'szktty 6/2/2011 01:47'!wordOr: otherWord	^ self class		with: (b1 bitOr: otherWord byte1)		with: (b2 bitOr: otherWord byte2)		with: (b3 bitOr: otherWord byte3)		with: (b4 bitOr: otherWord byte4)! !!SimpleWord methodsFor: 'word manipulation' stamp: 'szktty 6/6/2011 23:45'!wordRot: n	| v |	v := self asInteger.	v := n > 0		ifTrue: [ (v << n) bitOr: (v >> (32 - n)) ]		ifFalse: [ (v >> n) bitOr: (v << (32 - n)) ].	^ self class withInteger: v! !!SimpleWord methodsFor: 'word manipulation' stamp: 'szktty 6/2/2011 01:47'!wordXor: otherWord	^ self class		with: (b1 bitXor: otherWord byte1)		with: (b2 bitXor: otherWord byte2)		with: (b3 bitXor: otherWord byte3)		with: (b4 bitXor: otherWord byte4)! !!SimpleWord methodsFor: 'accessing' stamp: 'szktty 6/2/2011 01:09'!byte1	^ b1! !!SimpleWord methodsFor: 'accessing' stamp: 'szktty 6/2/2011 01:09'!byte1: byte	b1 := byte! !!SimpleWord methodsFor: 'accessing' stamp: 'szktty 6/2/2011 01:09'!byte2	^ b2! !!SimpleWord methodsFor: 'accessing' stamp: 'szktty 6/2/2011 01:09'!byte2: byte	b2 := byte! !!SimpleWord methodsFor: 'accessing' stamp: 'szktty 6/2/2011 01:09'!byte3	^ b3! !!SimpleWord methodsFor: 'accessing' stamp: 'szktty 6/2/2011 01:09'!byte3: byte	b3 := byte! !!SimpleWord methodsFor: 'accessing' stamp: 'szktty 6/2/2011 01:09'!byte4	^ b4! !!SimpleWord methodsFor: 'accessing' stamp: 'szktty 6/2/2011 01:09'!byte4: byte	b4 := byte! !!SimpleWord methodsFor: 'printing' stamp: 'szktty 6/7/2011 01:05'!hex	^ self asInteger hex! !!SimpleWord methodsFor: 'printing' stamp: 'szktty 6/2/2011 01:11'!printOn: stream	stream nextPutAll: ('#w[', b1 hex, ' ', b2 hex, ' ', b3 hex, ' ', b4 hex, ']')	! !!SimpleWord methodsFor: 'converting' stamp: 'szktty 6/2/2011 01:09'!asByteArray	^ ByteArray with: b1 with: b2 with: b3 with: b4! !!SimpleWord methodsFor: 'converting' stamp: 'szktty 6/6/2011 00:56'!asInteger	^ (b1 << 24) + (b2 << 16) + (b3 << 8) + b4! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!SimpleWord class	instanceVariableNames: ''!!SimpleWord class methodsFor: 'instance creation' stamp: 'szktty 6/5/2011 18:17'!fromHex: s	^ self withAll: (ByteArray readHexFrom: s)! !!SimpleWord class methodsFor: 'instance creation' stamp: 'szktty 6/2/2011 01:09'!with: bytes startingAt: i	^ self withAll: (bytes copyFrom: i to: i + 3)! !!SimpleWord class methodsFor: 'instance creation' stamp: 'szktty 6/2/2011 01:09'!with: b1 with: b2 with: b3 with: b4	^ self withAll: (ByteArray with: b1 with: b2 with: b3 with: b4)! !!SimpleWord class methodsFor: 'instance creation' stamp: 'szktty 6/2/2011 01:09'!withAll: bytes	^ self new withAll: bytes! !!SimpleWord class methodsFor: 'instance creation' stamp: 'szktty 6/6/2011 00:59'!withInteger: v	^ self		with: (v >> 24 bitAnd: 16rff)		with: (v >> 16 bitAnd: 16rff)		with: (v >> 8 bitAnd: 16rff)		with: (v bitAnd: 16rff)! !